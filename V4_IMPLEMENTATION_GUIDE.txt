# QRVCARD GENERATOR V4 - CODE UPDATE IMPLEMENTATION GUIDE

**Date:** October 29, 2025  
**Version:** V4 (Row 1 Buttons + Houzz Integration)

---

## CHANGES SUMMARY

### Manual Changes (YOU completed):
1. ✅ Inserted new Row 1 (pushing all data down)
   - Row 1: Empty (for export buttons)
   - Row 2: Headers (was Row 1)
   - Row 3+: Data (was Row 2+)

2. ✅ Moved Houzz URL column from AN → Y
   - Y: Houzz URL (NEW position)
   - Z-AN: All shifted right by 1

### Code Changes (COMPLETED):

**4 VBA Modules Updated:**
1. **Sheet2.cls** - Data Entry worksheet validation
2. **Module1_Core.bas** - Export orchestration
3. **Module2_VCardBuilder.bas** - vCard generation
4. **Module3_HTMLBuilder.bas** - HTML generation

**3 Modules UNCHANGED (no action needed):**
- ThisWorkbook.cls ✅
- Module4_QRCode.bas ✅
- Module5_Utilities.bas ✅
- frmProgress.frm ✅

---

## UPDATED COLUMN STRUCTURE (POST-CHANGES)

### Core Identity (B-M):
- B: Last Name*
- C: First Name*
- D: Middle Name
- E: Full Name (auto-calculated)
- F: Email*
- G: Phone Cell*
- H: Phone Office
- I: Extension
- J: Title Primary*
- K: Title Secondary
- L: Organization Primary*
- M: Organization Secondary

### Location (N-R):
- N: Street Address
- O: City*
- P: State*
- Q: Postal Code*
- R: Country

### Digital Presence (S-AC):
- S: Website URL
- T: LinkedIn URL
- U: Instagram URL
- V: Facebook URL
- W: Twitter/X URL
- X: Pinterest URL
- **Y: Houzz URL** ← MOVED FROM AN
- Z: YouTube URL (was Y)
- AA: GitHub URL (was Z)
- AB: Blog URL (was AA)
- AC: Cal.com Link (was AB)
- AD: Professional Bio (was AC)

### Assets & Config (AE-AI):
- AE: Profile Photo URL (was AD)
- AF: Company Logo URL (was AE)
- AG: Theme (was AF)
- AH: Franchise Code (was AG)
- AI: Analytics Enabled (was AH)

### Export Tracking (AJ-AN - AUTO-UPDATED):
- AJ: vCard Exported (was AI)
- AK: HTML Exported (was AJ)
- AL: Last Export Date (was AK)
- AM: Export Count (was AL)
- AN: Notes (was AM)

---

## IMPLEMENTATION INSTRUCTIONS

### STEP 1: Backup Current File
1. Save a copy of your current V4 file as `QRVCARD_GENERATOR_V4_BACKUP.xlsm`

### STEP 2: Import Updated VBA Modules

**In Excel:**
1. Press `Alt+F11` to open VBA Editor
2. In the Project Explorer (left panel), locate your workbook

**For each of the 4 updated modules:**

#### A. Sheet2.cls (Data Entry)
1. In VBA Editor: Right-click existing "Sheet2" under "Microsoft Excel Objects"
2. Select "Export File..." → Save current version as backup
3. Right-click "Sheet2" again → "Remove Sheet2"
4. Click "File" → "Import File..." → Select `Sheet2.cls`
5. The sheet will now use updated validation (Row 3+ checking)

#### B. Module1_Core.bas
1. In Project Explorer: Find "Module1_Core" under "Modules"
2. Right-click → "Export File..." → Save backup
3. Right-click → "Remove Module1_Core"
4. Click "File" → "Import File..." → Select `Module1_Core.bas`

#### C. Module2_VCardBuilder.bas
1. Find "Module2_VCardBuilder" under "Modules"
2. Right-click → "Export File..." → Save backup
3. Right-click → "Remove Module2_VCardBuilder"
4. Click "File" → "Import File..." → Select `Module2_VCardBuilder.bas`

#### D. Module3_HTMLBuilder.bas
1. Find "Module3_HTMLBuilder" under "Modules"
2. Right-click → "Export File..." → Save backup
3. Right-click → "Remove Module3_HTMLBuilder"
4. Click "File" → "Import File..." → Select `Module3_HTMLBuilder.bas`

### STEP 3: Verify Import
1. In VBA Editor, verify all 4 modules are present
2. Close VBA Editor (`Alt+Q`)
3. Save the workbook (`Ctrl+S`)

### STEP 4: Add Export Buttons (Row 1)

**On the Data Entry sheet, Row 1:**

Create 4 buttons using Developer Tab → Insert → Button (Form Control):

**Button 1: Export Single Row**
- Cell range: A1:D1
- Right-click → Assign Macro → `Module1_Core.ExportSingleRow`
- Right-click → Edit Text → "Export Single Row"

**Button 2: Export vCard Only**
- Cell range: E1:H1
- Right-click → Assign Macro → `Module1_Core.ExportVcardOnly`
- Right-click → Edit Text → "Export vCard Only"

**Button 3: Export HTML Only**
- Cell range: I1:L1
- Right-click → Assign Macro → `Module1_Core.ExportHTMLOnly`
- Right-click → Edit Text → "Export HTML Only"

**Button 4: Export All Marked Rows**
- Cell range: M1:P1
- Right-click → Assign Macro → `Module1_Core.ExportAll`
- Right-click → Edit Text → "Export All Marked Rows"

**Optional Formatting:**
- Set button background color to match header style
- Adjust font size for readability
- Align text center

### STEP 5: Test All Functionality

**Test Validation (Row 3+):**
1. Enter data in Row 3 (first data row)
2. Test name validation (B-D): Enter numbers → Should highlight red
3. Test email validation (F): Enter invalid email → Should highlight red
4. Test phone formatting (G-H): Enter "4109913275" → Should format to "(410) 991-3275"
5. Test extension validation (I): Enter letters → Should highlight red

**Test Single Row Export:**
1. Click on any data row (Row 3+)
2. Click "Export Single Row" button
3. Select output folder
4. Verify both .vcf and .html files created
5. Open HTML file → Verify Houzz icon appears if URL filled

**Test Batch Export:**
1. Mark multiple rows in Column A (type "x")
2. Click "Export All Marked Rows" button
3. Select output folder
4. Verify progress bar appears and updates
5. Check all files exported successfully
6. Verify export tracking updated (columns AJ-AM)

**Test Houzz Integration:**
1. Add Houzz URL in column Y (e.g., https://www.houzz.com/pro/closetfactorybrand)
2. Export HTML
3. Open in browser
4. Verify green Houzz icon appears in social media section
5. Click icon → Should open Houzz page in new tab

---

## KEY CODE CHANGES REFERENCE

### Row Validation Changes
**OLD:** `If cell.Row >= 2` (validated Row 2+)  
**NEW:** `If cell.Row >= 3` (validates Row 3+)

**OLD:** `If currentRow < 2` (error for Row 1)  
**NEW:** `If currentRow < 3` (error for Rows 1-2)

**OLD:** `For i = 2 To lastRow` (started at Row 2)  
**NEW:** `For i = 3 To lastRow` (starts at Row 3)

### Column Mapping Changes

**Bio Column:**
- OLD: `GetCellValue(ws, rowNum, "AC")`
- NEW: `GetCellValue(ws, rowNum, "AD")`

**Theme Column:**
- OLD: `GetCellValue(ws, rowNum, "AF")`
- NEW: `GetCellValue(ws, rowNum, "AG")`

**Franchise Code Column:**
- OLD: `GetCellValue(ws, rowNum, "AG")`
- NEW: `GetCellValue(ws, rowNum, "AH")`

**Analytics Column:**
- OLD: `GetCellValue(ws, rowNum, "AH")`
- NEW: `GetCellValue(ws, rowNum, "AI")`

**Export Tracking Columns (LogExport function):**
- vCard Exported: AI → **AJ**
- HTML Exported: AJ → **AK**
- Last Export Date: AK → **AL**
- Export Count: AL → **AM**

**Social Media Columns:**
- YouTube: Y → **Z**
- GitHub: Z → **AA**
- Blog: AA → **AB**
- Cal.com: AB → **AC**
- **Houzz: NEW at Y** ← Added

**Social Media Icon Count:**
- OLD: `For i = 1 To 9` (9 platforms)
- NEW: `For i = 1 To 10` (10 platforms including Houzz)

---

## HOUZZ SOCIAL MEDIA DETAILS

**Column:** Y  
**Icon:** H (green circle)  
**Color:** #4DBC15 (Houzz brand green)  
**Title:** "Houzz"  
**Example URL:** https://www.houzz.com/pro/closetfactorybrand

The Houzz icon will only appear in exported HTML if column Y contains a URL.

---

## TROUBLESHOOTING

### Problem: "Compile Error: Invalid outside procedure"
**Solution:** Ensure you imported entire module files, not just code snippets

### Problem: Buttons don't appear in Row 1
**Solution:** 
1. Verify Row 1 is completely empty before adding buttons
2. Use Developer Tab → Insert → Button (Form Control)
3. Assign macros by right-clicking button

### Problem: Validation still checking Row 2
**Solution:** 
1. Verify Sheet2.cls was imported successfully
2. Check code shows `If cell.Row >= 3`
3. Close and reopen Excel to force reload

### Problem: Houzz icon not appearing in HTML
**Solution:**
1. Verify Houzz URL is in column Y (not old column AN)
2. Ensure URL is valid format (starts with http:// or https://)
3. Re-export HTML file

### Problem: Export tracking in wrong columns
**Solution:**
1. Verify Module1_Core.bas was imported successfully
2. Check LogExport function uses columns AJ-AM
3. Clear old tracking data and re-export

### Problem: Bio not showing in vCard or HTML
**Solution:**
1. Verify bio is in column AD (not old column AC)
2. Check Module2_VCardBuilder and Module3_HTMLBuilder both reference "AD"

---

## FILE DELIVERABLES

**VBA Modules (4 files):**
- ✅ Sheet2.cls
- ✅ Module1_Core.bas
- ✅ Module2_VCardBuilder.bas
- ✅ Module3_HTMLBuilder.bas

**Documentation:**
- ✅ This implementation guide

---

## VALIDATION CHECKLIST

After implementation, verify:

- [ ] Row 1 contains 4 export buttons
- [ ] Row 2 contains headers (all column headers present)
- [ ] Row 3+ contains data
- [ ] Name validation works (highlights invalid names in red)
- [ ] Email validation works (highlights invalid emails in red)
- [ ] Phone auto-formats to (XXX) XXX-XXXX
- [ ] Extension validation works (only accepts numbers)
- [ ] Column Y contains Houzz URLs (if applicable)
- [ ] Single row export works (creates .vcf + .html)
- [ ] vCard-only export works
- [ ] HTML-only export works
- [ ] Batch export works (with progress bar)
- [ ] Houzz icon appears in HTML when Y has URL
- [ ] Export tracking updates columns AJ-AM correctly
- [ ] All 10 social media icons work (including Houzz)

---

## TOKEN USAGE SUMMARY

**Chat Context:**
- Used: ~98,000 / 190,000 (52%)
- Remaining: ~92,000 (48%)
- Status: ✅ Excellent - plenty of room for follow-up

---

## SUPPORT

**Questions or Issues:**
Contact: gmatas@closetfactoryhq.com

**Version:** V4 Production Ready (Post-Row-1-Buttons Update)  
**Last Updated:** October 29, 2025
