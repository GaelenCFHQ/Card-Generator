==============================================================================
QRVCARD GENERATOR V4 - TECHNICAL ARCHITECTURE
==============================================================================

PROJECT OVERVIEW
Version: 4.0 (Production Ready)
Purpose: Generate vCard (.vcf) and HTML digital business cards
Platform: Excel VBA (macro-enabled workbook)
Standards: vCard 3.0 (RFC 2426), HTML5, GA4

==============================================================================
FILE STRUCTURE
==============================================================================

QRVCARD_GENERATOR_V4.xlsm
â”œâ”€â”€ Worksheets (3)
â”‚   â”œâ”€â”€ Instructions      Quick start guide, column reference
â”‚   â”œâ”€â”€ Data Entry        39 columns with validation & formulas
â”‚   â””â”€â”€ Settings          Google Analytics configuration
â”‚
â”œâ”€â”€ VBA Project
â”‚   â”œâ”€â”€ Microsoft Excel Objects
â”‚   â”‚   â”œâ”€â”€ ThisWorkbook.cls          Workbook events
â”‚   â”‚   â””â”€â”€ Sheet1.cls (Data Entry)   Data validation events
â”‚   â”‚
â”‚   â”œâ”€â”€ Forms
â”‚   â”‚   â””â”€â”€ frmProgress               Progress bar (MANDATORY)
â”‚   â”‚
â”‚   â””â”€â”€ Modules
â”‚       â”œâ”€â”€ Module1_Core              Export orchestration
â”‚       â”œâ”€â”€ Module2_VCardBuilder      vCard generation
â”‚       â”œâ”€â”€ Module3_HTMLBuilder       HTML generation
â”‚       â”œâ”€â”€ Module4_QRCode            QR code API integration
â”‚       â””â”€â”€ Module5_Utilities         Helper functions

==============================================================================
DATA FLOW ARCHITECTURE
==============================================================================

                           USER ACTION
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                       â”‚
              Single Export           Batch Export
                    â”‚                       â”‚
                    â†“                       â†“
           MODULE 1: CORE         MODULE 1: CORE
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           â€¢ Validate fields      â€¢ Get marked rows
           â€¢ Get folder path      â€¢ Get folder path
           â€¢ Generate filename    â€¢ CREATE PROGRESS BAR â†â”€â”€ MANDATORY
                    â”‚                       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                     â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  MODULE 2: VCARD   â”‚    â”‚  MODULE 3: HTML â”‚
          â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
          â”‚  â€¢ Read row data    â”‚    â”‚  â€¢ Read row dataâ”‚
          â”‚  â€¢ Format name      â”‚    â”‚  â€¢ Call vCard   â”‚â—„â”€â”
          â”‚  â€¢ Build RFC 2426   â”‚    â”‚  â€¢ Call QR code â”‚  â”‚
          â”‚  â€¢ Write .vcf       â”‚    â”‚  â€¢ Build HTML   â”‚  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â€¢ Social icons â”‚  â”‚
                                    â”‚  â€¢ Embed QR     â”‚  â”‚
                                    â”‚  â€¢ Analytics    â”‚  â”‚
                                    â”‚  â€¢ Write .html  â”‚  â”‚
                                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                         â”‚               â”‚
                                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                                    â”‚ MODULE 4: QRCODEâ”‚  â”‚
                                    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚
                                    â”‚ â€¢ URL encode    â”‚  â”‚
                                    â”‚ â€¢ Google Charts â”‚  â”‚
                                    â”‚ â€¢ Return URL    â”‚  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                         â”‚               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ MODULE 5: UTILITIES â”‚
          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
          â”‚ â€¢ SanitizeFilename  â”‚
          â”‚ â€¢ GetCellValue      â”‚
          â”‚ â€¢ FormatPhone       â”‚
          â”‚ â€¢ ValidateEmail     â”‚
          â”‚ â€¢ EscapeHTML        â”‚
          â”‚ â€¢ DebugLog          â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â†“
            Update Export Tracking
            (Columns AI-AL)
                    â”‚
                    â†“
              Success Message

==============================================================================
MODULE DEPENDENCIES
==============================================================================

Module1_Core
â”œâ”€â”€ Depends on: Module2_VCardBuilder, Module3_HTMLBuilder, Module5_Utilities
â”œâ”€â”€ Uses: frmProgress (MANDATORY for ExportAll)
â””â”€â”€ Public Functions:
    â”œâ”€â”€ ExportSingleRow()   - vCard + HTML
    â”œâ”€â”€ ExportVcardOnly()   - vCard only
    â”œâ”€â”€ ExportHTMLOnly()    - HTML only
    â””â”€â”€ ExportAll()         - Batch with progress bar

Module2_VCardBuilder
â”œâ”€â”€ Depends on: Module5_Utilities
â”œâ”€â”€ Standalone: Can be used independently
â””â”€â”€ Public Functions:
    â”œâ”€â”€ SaveVcard()         - Generate and save
    â””â”€â”€ GenerateVcard()     - Return vCard text

Module3_HTMLBuilder
â”œâ”€â”€ Depends on: Module2_VCardBuilder, Module4_QRCode, Module5_Utilities
â”œâ”€â”€ Complex: Most feature-rich module
â””â”€â”€ Public Functions:
    â””â”€â”€ SaveHTML()          - Generate and save HTML

Module4_QRCode
â”œâ”€â”€ Depends on: Module5_Utilities (optional, for logging only)
â”œâ”€â”€ Standalone: Can be used independently
â””â”€â”€ Public Functions:
    â”œâ”€â”€ GenerateQRCodeDataURL()  - Return Google Charts URL
    â””â”€â”€ GetQRCodeImageSize()     - Get size from Settings

Module5_Utilities
â”œâ”€â”€ Depends on: None (fully standalone)
â”œâ”€â”€ Purpose: Shared helper functions
â””â”€â”€ Public Functions:
    â”œâ”€â”€ SanitizeFilename()       - Clean filenames
    â”œâ”€â”€ GetCellValue()           - Safe cell retrieval
    â”œâ”€â”€ BuildFormattedName()     - Name construction
    â”œâ”€â”€ GetSettingValue()        - Setting retrieval
    â”œâ”€â”€ FormatPhoneNumber()      - Phone formatting
    â”œâ”€â”€ ValidateEmail()          - Email validation
    â”œâ”€â”€ EscapeHTML()             - HTML escaping
    â””â”€â”€ DebugLog()               - Debug logging

ThisWorkbook.cls
â”œâ”€â”€ Depends on: Module5_Utilities (optional logging)
â””â”€â”€ Events:
    â”œâ”€â”€ Workbook_Open()          - Initialize on open
    â””â”€â”€ Workbook_BeforeClose()   - Cleanup before close

Sheet1.cls (Data Entry)
â”œâ”€â”€ Depends on: Module5_Utilities
â””â”€â”€ Events:
    â””â”€â”€ Worksheet_Change()       - Validate on data entry

frmProgress (UserForm)
â”œâ”€â”€ Depends on: None (standalone UI)
â””â”€â”€ Public Methods:
    â”œâ”€â”€ InitializeProgress()     - Setup
    â””â”€â”€ UpdateProgress()         - Update display

==============================================================================
39-COLUMN DATA MODEL
==============================================================================

Column Groups:
  A-M   (13 cols)  Core Identity      Blue headers
  N-R   (5 cols)   Location           Gray headers
  S-AC  (11 cols)  Digital Presence   Green headers
  AD-AH (5 cols)   Assets & Control   Orange headers
  AI-AM (5 cols)   Export Tracking    Yellow headers

Key Design Decisions:

1. Dual Role Support
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   J + K: Two titles
   L + M: Two organizations
   vCard: Combined in TITLE + NOTE fields
   HTML: Both displayed prominently

2. Auto-Calculation
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Column E: Full Name formula
   Format: =TRIM(IF(D2="",C2&" "&B2,C2&" "&D2&" "&B2))
   Handles missing middle name gracefully

3. Export Marker
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Column A: Any non-empty value
   Flexible: x, âœ“, 1, yes, etc.
   Used by: ExportAll() for batch selection

4. Social Media
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   10 platforms (T-AB)
   Icons only appear if URL filled
   Platform-specific colors
   Font-based icons (no image dependencies)

5. Export Tracking
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   AI-AL: Auto-updated by export functions
   AL: Export count increments
   Useful for distribution tracking

==============================================================================
VCARD GENERATION (RFC 2426)
==============================================================================

Standard: vCard 3.0
Encoding: UTF-8
Line ending: CRLF (vbCrLf)

Structure:
  BEGIN:VCARD
  VERSION:3.0
  N:Last;First;Middle;;
  FN:Full Name
  ORG:Organization Primary
  TITLE:Title Primary
  TEL;TYPE=CELL,VOICE:phone
  TEL;TYPE=WORK,VOICE:phone x ext
  EMAIL;TYPE=INTERNET,PREF:email
  URL:website
  ADR;TYPE=WORK:;;street;city;state;postal;country
  NOTE:Secondary role + bio
  REV:timestamp
  END:VCARD

Dual Role Handling:
  - Primary: ORG + TITLE fields
  - Secondary: NOTE field
  - Bio: Appended to NOTE

Phone Formatting:
  - Cell: TYPE=CELL,VOICE (primary)
  - Office: TYPE=WORK,VOICE (secondary)
  - Extension: Appended as " xNNN"

==============================================================================
HTML GENERATION
==============================================================================

Technology Stack:
  - HTML5
  - CSS3 (embedded stylesheet)
  - Vanilla JavaScript (GA4 only)
  - No external dependencies

Design Features:
  - Responsive (mobile-friendly)
  - Gradient background
  - Rounded card design
  - Shadow effects
  - Hover states
  - Theme support (4 color schemes)

Components:
  1. Header
     â”œâ”€â”€ Full name (h1)
     â”œâ”€â”€ Primary role + org
     â””â”€â”€ Secondary role + org (if present)

  2. Content
     â”œâ”€â”€ Contact info rows
     â”œâ”€â”€ Professional bio
     â”œâ”€â”€ Social media icons
     â”œâ”€â”€ QR code (embedded data URL)
     â””â”€â”€ Download button (data URI)

  3. Analytics (optional)
     â””â”€â”€ GA4 tracking script

Social Media Icons:
  Platform    Column  Icon  Color
  â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€
  LinkedIn    T       in    #0077B5
  Instagram   U       ðŸ“·    #E4405F
  Facebook    V       f     #1877F2
  Twitter/X   W       ð•     #000000
  Pinterest   X       P     #E60023
  YouTube     Y       â–¶     #FF0000
  GitHub      Z       âš›     #333333
  Blog        AA      âœ     #FF6B6B
  Cal.com     AB      ðŸ“…    #292929

Icon Implementation:
  - Font-based (Unicode characters)
  - No image files required
  - Circular buttons (44px)
  - Platform colors
  - Hover effect (lift + shadow)

==============================================================================
QR CODE GENERATION
==============================================================================

API: Google Charts API
URL: https://chart.googleapis.com/chart

Parameters:
  cht=qr                  Chart type: QR code
  chs=250x250             Size (configurable)
  chl=[encoded_vcard]     Data (URL-encoded vCard)
  choe=UTF-8              Encoding
  chld=M|1                Error correction Medium, margin 1

Error Correction Levels:
  L: 7% recovery
  M: 15% recovery (default)
  Q: 25% recovery
  H: 30% recovery

URL Encoding:
  - Special characters â†’ %XX hex codes
  - Space â†’ %20
  - Newline â†’ %0D%0A
  - Colon â†’ %3A
  - Semicolon â†’ %3B

Size Validation:
  - Min: 100px
  - Max: 500px
  - Default: 250px
  - Configurable in Settings sheet

Internet Dependency:
  âœ“ Requires internet connection
  âœ“ Real-time generation (no storage)
  âœ“ No API key required (public service)

==============================================================================
GOOGLE ANALYTICS INTEGRATION
==============================================================================

Standard: GA4 (Google Analytics 4)
Implementation: gtag.js (Global Site Tag)

Configuration:
  1. Property ID in Settings sheet (B11)
  2. Per-user enable in Data Entry (AH)
  3. Franchise code for tracking (AG)

Tracking Structure:
  Property ID â†’ From Settings sheet
  â””â”€â”€ Custom Dimensions (event-scoped)
      â”œâ”€â”€ card_owner: Full name
      â”œâ”€â”€ primary_role: Title Primary
      â””â”€â”€ franchise_code: Franchise Code

Events Tracked:
  1. page_view (automatic)
     - Fires on HTML page load
     - Includes custom dimensions

  2. vcard_download (future)
     - Fires on Download Contact click
     - Requires JavaScript enhancement

Dual Property Support:
  B11: Corporate GA4 Property ID
  B12: Franchise GA4 Property ID
  
  Use case: Track all cards corporately,
            plus franchise-specific tracking

==============================================================================
DATA VALIDATION SYSTEM
==============================================================================

Implementation: Sheet1.cls Worksheet_Change event
Pattern: Intersect() for efficient event handling

Validation Rules:

Column B-D (Names):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Rule: Letters, spaces, hyphens, apostrophes only
  Regex: [A-Za-z \-']+
  Invalid: Highlight red (RGB 255, 200, 200)
  Valid: No highlighting

Column F (Email):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Rule: Must contain @ and .
  Logic: atPos > 1 AND dotPos > atPos + 1 AND dotPos < length
  Invalid: Highlight red
  Valid: No highlighting

Column G-H (Phones):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Rule: Auto-format to (XXX) XXX-XXXX
  Process: Extract digits â†’ Reformat
  Handles: 10-digit and 11-digit (with leading 1)

Column I (Extension):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Rule: Numeric only
  Invalid: Highlight red
  Valid: Format as text (@)

Column AF (Theme):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Type: Dropdown validation
  Values: Default | Dark | Corporate | Minimal

Column AH (Analytics):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Type: Dropdown validation
  Values: TRUE | FALSE

Event Optimization:
  - EnableEvents = False during changes
  - Only process rows >= 2 (skip header)
  - Intersect() checks specific columns only
  - No full worksheet scan

==============================================================================
PROGRESS BAR IMPLEMENTATION
==============================================================================

Form: frmProgress (UserForm)
Requirement: MANDATORY for ExportAll()

Controls:
  lblTitle       Title label
  lblProgress    Current item label
  lblStatus      Status text (X of Y)
  frmProgressBar Background frame (gray)
  lblBar         Progress bar (blue, width animates)

Behavior:
  1. Show modeless (vbModeless)
  2. InitializeProgress(totalCount)
  3. FOR EACH item:
       UpdateProgress(itemNumber, itemName)
       DoEvents (keep responsive)
  4. Unload form

Progress Calculation:
  percentComplete = (itemNumber / totalCount) * 100
  barWidth = maxWidth * (percentComplete / 100)

Why Mandatory:
  - User feedback critical for batch operations
  - Prevents "Excel not responding" perception
  - Shows current item being processed
  - Provides cancel opportunity (DoEvents)
  - Professional user experience

==============================================================================
EXPORT TRACKING SYSTEM
==============================================================================

Columns: AI-AM (Auto-updated)

AI: vCard Exported
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    Values: TRUE | (empty)
    Set by: ExportVcardOnly, ExportSingleRow, ExportAll

AJ: HTML Exported
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    Values: TRUE | (empty)
    Set by: ExportHTMLOnly, ExportSingleRow, ExportAll

AK: Last Export Date
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    Format: yyyy-mm-dd hh:mm:ss
    Updated: Every export
    Uses: VBA Now() function

AL: Export Count
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    Type: Integer
    Increments: On every export
    Use case: Track card distribution
             Identify most-shared cards

AM: Notes
    â”€â”€â”€â”€â”€
    Type: Free text (user editable)
    Purpose: Manual tracking notes
    Examples: "Sent to trade show 10/29"
             "Printed 50 copies"

Update Logic:
  Private Sub LogExport(ws, rowNum, exportType)
    If exportType includes VCARD: AI = TRUE
    If exportType includes HTML:  AJ = TRUE
    AK = Now()
    AL = AL + 1
  End Sub

==============================================================================
ERROR HANDLING STRATEGY
==============================================================================

Pattern: "On Error Resume Next" + Validation

Module1_Core:
  âœ“ Validate required fields before export
  âœ“ Check folder path selection (cancel = exit)
  âœ“ Generate safe filenames (sanitize)
  âœ“ Show user-friendly error messages

Module2_VCardBuilder:
  âœ“ Return empty string on error
  âœ“ Log errors via DebugLog
  âœ“ Safe cell value retrieval

Module3_HTMLBuilder:
  âœ“ Return empty string on error
  âœ“ Validate settings (GA property ID)
  âœ“ HTML escape all user data

Module4_QRCode:
  âœ“ Return empty string on error
  âœ“ URL encode special characters
  âœ“ Validate size parameters

Module5_Utilities:
  âœ“ All functions return safe defaults
  âœ“ GetCellValue returns "" on error
  âœ“ Never throw unhandled exceptions

Debug Logging:
  #If VBA7 Then
    Debug.Print timestamp | module | function | message
  #End If

  Only active in VBA editor (development mode)
  No performance impact in production

==============================================================================
SECURITY & PRIVACY
==============================================================================

Data Storage:
  âœ“ All data stored locally in Excel file
  âœ“ No cloud sync without user action
  âœ“ User controls export location

Network Calls:
  âœ“ Google Charts API (QR generation only)
  âœ“ Google Analytics (optional, user controlled)
  âœ“ No other external services

Macro Security:
  âœ“ Requires user to enable macros
  âœ“ Follows Excel security model
  âœ“ No auto-execution code
  âœ“ No Windows API calls
  âœ“ No shell execution

Social Media URLs:
  âœ“ User-provided (no scraping)
  âœ“ Validated format only
  âœ“ No authentication required

Analytics:
  âœ“ Opt-in per user (Column AH)
  âœ“ No personal data sent without user data
  âœ“ User controls GA property
  âœ“ Standard GA4 privacy policy applies

==============================================================================
PERFORMANCE CONSIDERATIONS
==============================================================================

Batch Export Optimization:
  âœ“ Progress bar: DoEvents every iteration
  âœ“ No unnecessary recalculation
  âœ“ Direct cell access (no loops)
  âœ“ Single file save per item

Worksheet Events:
  âœ“ Intersect() pattern (not full sheet scan)
  âœ“ EnableEvents = False during changes
  âœ“ Process only changed cells
  âœ“ No validation on header row

Formula Optimization:
  âœ“ Column E: Single formula, no array
  âœ“ Copied down (no volatile functions)
  âœ“ Manual calculation mode compatible

Memory Management:
  âœ“ Set objects = Nothing after use
  âœ“ Unload forms explicitly
  âœ“ No persistent global variables
  âœ“ Collections freed after batch

Expected Performance:
  Single export: < 1 second
  Batch export: ~2-3 seconds per card
  100 cards: ~5 minutes with progress bar

==============================================================================
PHASE 2 FEATURES (Future Development)
==============================================================================

1. Photo Integration (AD-AE)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Base64 encode profile photo
   - Embed in vCard PHOTO field
   - Display in HTML header
   - Support: JPG, PNG (< 100KB)

2. QR Code Local Generation
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Remove Google Charts API dependency
   - Use VBA QR library or Python integration
   - Offline capability
   - Custom QR styling

3. Email Signature Templates
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - HTML email signature export
   - Outlook-compatible format
   - Gmail-compatible format
   - Include social icons

4. Franchise Branding
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Custom color schemes per franchise
   - Logo integration
   - Template variants
   - Brand guideline enforcement

5. Cloud Hosting Automation
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - FTP upload integration
   - GitHub Pages auto-deploy
   - Dropbox/Drive sync
   - URL shortener integration

6. Multi-Language Support
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Translate interface labels
   - Locale-specific phone formats
   - Address format variations
   - Character set handling

7. vCard Enhanced Fields
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - PHOTO (with photo integration)
   - NICKNAME
   - CATEGORIES
   - ANNIVERSARY
   - GENDER

8. Advanced Analytics
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Scan tracking (QR code hits)
   - Download tracking (vCard downloads)
   - Geographic distribution
   - Device detection (mobile vs desktop)

==============================================================================
TROUBLESHOOTING GUIDE
==============================================================================

Issue: "Corrupted file" error when opening
Solution: File is .xlsx (not .xlsm yet)
Action: Import VBA modules first, then save as .xlsm

Issue: Macros disabled
Solution: Yellow security bar appears
Action: Click "Enable Content"

Issue: Export buttons missing
Solution: Buttons not created yet
Action: Add buttons manually (Developer tab â†’ Insert â†’ Button)
        OR: Use Alt+F8 â†’ Select macro â†’ Run

Issue: "Progress bar not found" error
Solution: frmProgress not imported or controls missing
Action: Verify frmProgress exists in Forms folder
        Verify all 5 controls created (lblTitle, lblProgress, etc.)

Issue: Phone number not formatting
Solution: Invalid phone number (not 10 digits)
Action: Enter 10-digit number: 4109913275
        Auto-formats to: (410) 991-3275

Issue: Email validation failing
Solution: Missing @ or . in email
Action: Verify email format: user@domain.com

Issue: QR code not loading in HTML
Solution: No internet connection
Action: Google Charts API requires internet
        OR: File opened from local drive (use web server)

Issue: Google Analytics not tracking
Solution: Property ID not configured
Action: Settings sheet â†’ Cell B11 â†’ Paste GA4 Property ID
        Data Entry sheet â†’ Column AH â†’ Set TRUE

Issue: Export All completes but no files created
Solution: No rows marked for export
Action: Column A â†’ Type "x" in rows to export

Issue: Files saving to wrong location
Solution: Folder picker default path
Action: Browse to desired location in folder picker dialog
        Default: Documents folder

==============================================================================
DEVELOPMENT STANDARDS
==============================================================================

Code Style:
  âœ“ 4-space indentation (never tabs)
  âœ“ Descriptive function/variable names
  âœ“ Comment blocks for each function
  âœ“ Header comment for each module
  âœ“ "Option Explicit" in every module

Error Handling:
  âœ“ Every Public function has error handler
  âœ“ Return safe defaults on error
  âœ“ Log errors via DebugLog
  âœ“ User-friendly error messages

Testing:
  âœ“ Test with single row first
  âœ“ Test with multiple rows (batch)
  âœ“ Test with missing optional fields
  âœ“ Test with invalid data (validation)
  âœ“ Test with long text (bio, names)
  âœ“ Verify .vcf imports correctly
  âœ“ Verify .html renders correctly

Version Control:
  âœ“ Save .xlsm file before major changes
  âœ“ Export VBA modules to .bas/.cls files
  âœ“ Document changes in Notes column (AM)
  âœ“ Increment version in Instructions sheet

==============================================================================
SUPPORT & MAINTENANCE
==============================================================================

Contact: gmatas@closetfactoryhq.com

Documentation:
  - V4_IMPORT_INSTRUCTIONS.txt  Setup guide
  - V4_QUICK_REFERENCE.txt      Field reference
  - V4_ARCHITECTURE.txt         This file

Code Maintenance:
  - All code commented and documented
  - Modular architecture for easy updates
  - No hardcoded paths or values
  - Settings sheet for configuration

Future Updates:
  - Phase 2 features (see above)
  - Additional export formats
  - Enhanced analytics
  - UI improvements

==============================================================================
LICENSE & ATTRIBUTION
==============================================================================

Developer: Gaelen Matas
Organization: Closet Factory
Version: 4.0
Date: October 2025

Technologies:
  - Microsoft Excel VBA
  - Google Charts API (QR codes)
  - Google Analytics 4 (optional)
  - vCard 3.0 (RFC 2426)
  - HTML5 / CSS3

Standards Compliance:
  âœ“ vCard 3.0 (RFC 2426)
  âœ“ HTML5 / CSS3
  âœ“ GA4 tracking specifications
  âœ“ Excel VBA best practices

==============================================================================
